import{a as M,b as w,c as A}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-GSRTYWM3.js";import{b as O,c as y,h as F,l as x,r as B}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-EKJN7WW7.js";import{b as T}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-HWRUU3JJ.js";import{a as k,e as b,g as R,h as S}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-OSYQOFPB.js";import{a as h,b as V}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-DYZTW7WS.js";import{D as P,F as v}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-U4GS6NTD.js";import{a as I}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-IFNIQOEY.js";import{d as C}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-JPR5YHB4.js";V();A();var L=C(I());O();A();S();var r=C(I());B();function D({interactions:i,player:t,sharedState:s}){let{clickCount:a,isPlayerReady:l,isPointerIn:p,hoverPercent:u,scrollPercent:d,isStarted:m}=R(s),c=(0,r.useRef)(k({loopCount:0,prevClickCount:0,isSecondClickPending:!1,isUnholdPending:!1,isUnhoverPending:!1,isReverseActionInProgress:!1})).current,n=(0,r.useMemo)(()=>{let e={};for(let o of i)e[o.type]=F(i,o.type);return e},[i]);(0,r.useEffect)(()=>{let e=i[0];if(!e)return;function o(){e.range||t.setRange([0,t.state.totalFrames-1]),e?.direction===-1?t.seek(e.range?.[1]||t.state.totalFrames-1||0):e.range&&t.seek(e.range[0]||0)}return t.addEventListener("Ready",o,{once:!0}),()=>t.removeEventListener("Ready",o)},[]);function g(e){let o=-(e.direction||1);t.play({direction:o,loop:!1})}(0,r.useEffect)(()=>{let e=n.click;if(!e||c.prevClickCount===a)return;let o=U(e),f=o==="reverse"?!1:e.loop;!c.isSecondClickPending||t.state.isComplete&&e.secondAction!=="reverse"?(t.state.isComplete&&t.stop(),t.play({range:e.range,loop:f,loopCount:e.loopInfinite?void 0:e.loopCount,direction:e.direction,speed:e.speed}),c.isSecondClickPending=!0):(o==="reverse"?g(e):t.pause(),c.isSecondClickPending=!1),c.prevClickCount=a},[n,a,t]),(0,r.useEffect)(()=>{let e,o=n.load;if(o){if(l&&m){let f=typeof o.delay=="number"?o.delay*1e3:0;e=setTimeout(()=>{t.play({range:o.range,loop:o.loop,loopCount:o.loopInfinite?void 0:o.loopCount,direction:o.direction,speed:o.speed})},f)}return()=>clearTimeout(e)}},[n,l,t,m]),(0,r.useEffect)(()=>{let e=n.hover;if(!e)return;let o=U(e),f=o==="reverse"?!1:e.loop;p?(t.play({range:e.range,loop:f,loopCount:e.loopInfinite?void 0:e.loopCount,direction:e.direction,speed:e.speed}),c.isUnhoverPending=!0):c.isUnhoverPending&&(o==="reverse"?g(e):t.pause(),c.isUnhoverPending=!1)},[n,p,t]),(0,r.useEffect)(()=>{let e=n.cursor;e&&t.seek(E({range:e.range,percent:u,totalFrames:t.state.totalFrames,direction:e.direction,loopCount:e.loop?e.loopCount:void 0,bounce:e.loop==="swing"}))},[n,u,t,t.state.totalFrames]),(0,r.useEffect)(()=>{let e=n.scroll;if(!e)return;let o=e.scrollType!=="relative"?e.loopInfinite??!0:!1;t.seek(E({range:e.range,percent:d,totalFrames:t.state.totalFrames,direction:e.direction,loopCount:e.loop?o?y:e.loopCount??1:1,bounce:e.loop==="swing"}))},[n,d,t,t.state.totalFrames])}function E({range:i,percent:t=0,totalFrames:s=0,direction:a,loopCount:l=1,bounce:p}){let u=i||[0,s-1],d=u[0],m=u[1],c=Math.max(Math.min(t,1),0),n=Math.max(m-d+1,0),g=n*l,e=Math.max(Math.round((g-1)*c),0),o=e%n;a===-1&&(o=n-o-1);let f=Math.floor(e/n);return p&&f%2&&(o=n-o-1),o=Math.max(Math.min(o+d,s-1),0),o}function U(i){return i.secondAction||x()}S();v();var H=[];function N({widget:i,sharedState:t}){let[s]=(0,L.useState)(()=>new M),{ref:a,inView:l}=T();return(0,L.useEffect)(()=>{l&&(t.isStarted=!0)},[t,l]),D({interactions:i.interactions||H,player:s,sharedState:t}),P(h,{width:"100%",height:"100%",pointerEvents:"none",ref:a,children:P(w,{uri:i.uri,player:s,onReady:()=>{t.isPlayerReady=!0,t.player=b(s)}})})}var ce=N;export{N as a,ce as b};
