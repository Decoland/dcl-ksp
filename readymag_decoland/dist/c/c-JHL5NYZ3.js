import{a as _e,b as oo}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-NOCQDQPR.js";import{b as zn,c as It,d as Vn,e as Yn,f as Gn,h as Jn,i as qn}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-HE7B2QDJ.js";import{b as ao,c as Hr}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-525NTXBN.js";import{b as $n,c as Or,d as to,e as Fr}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-I3R4F7CZ.js";import{a as Xn,b as Zn,c as Qn,d as eo,f as nt,g as Ie,i as ot}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-P3IPVYZK.js";import{b as hr}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-EKH35OWM.js";import{$ as wn,Ab as Kn,B as xt,Bb as pe,C as Ct,Ca as On,D as un,E as fn,F as pn,Fa as Fn,Ga as Et,H as bt,Ha as Ln,I as mn,J as gn,K as kr,M as hn,O as vr,P as Fe,Pa as vt,R as Sn,Sa as wt,Ua as he,V as vn,Xa as K,_ as Ar,a as Sr,b as Tr,ba as Pr,c as xr,eb as Un,f as Ge,fb as _n,ga as Ee,gb as Mn,ha as In,hb as Dn,kb as Bn,la as An,lb as Hn,ma as tt,mb as Nn,nb as Wn,oa as Pn,p as nn,q as be,ta as Ue,ua as Rn,va as ve,yb as de,z as Xe}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-6BD5TTOJ.js";import{a as Le,g as bn}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-HJ6CUHFE.js";import{a as ro,b as _r}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-AG5SGBDW.js";import{r as io,u as Dr}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-KODFG4HI.js";import{A as Tt,D as ln,E as cn,G as dn,H as Ze,I as yn,J as kt,e as Cr,f as Y,g as en,i as Re,j as Je,l as on,o as rn,p as sn,s as St,t as Oe,u as qe,y as an,z as ke}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-5U7VAUQ6.js";import{d as et,e as kn,g as En}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-COTV32KC.js";import{b as Er}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-H3ILHJQN.js";import{f as tn,t as br}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-LCYIYNO6.js";import{a as At,b as Br}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-CFL4VMO6.js";import{a as so,b as Mr}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-UF5VAS5F.js";import{a as Jt,b as yr}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-QE7PLCIB.js";import{a as no,b as Lr}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-ZKJOYTOA.js";import{a as R,b as we}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-DYZTW7WS.js";import{a as Ur}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-SQKOFC7D.js";import{n as jn,o as Rr}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-CVGBW63P.js";import{r as Ce,v as Ye}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-KYPTAB4E.js";import{g as Qe,h as Cn}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-UWYBG7UU.js";import{d as Ir}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-3SINCH5B.js";import{a as Tn,b as wr}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-NVZHNET7.js";import{a as Qt}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-5YHS57LW.js";import{a as xn}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-QV7VCXGU.js";import{c as Xt,e as Zt}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-MJ34YYKA.js";import{C as ye,D as h,E as V,F as oe,d as ze,e as qt,v as Ve}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-U4GS6NTD.js";import{a as ce}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-IFNIQOEY.js";import{x as Vt,y as Yt,z as Gt}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-45DYIENQ.js";import{a as gr}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-V5DTUMCE.js";import{a as U,c as ht}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-WPVKPCDO.js";import{a as L,d as N}from"https://st-p.rmcdn.net/2ec2f837/dist/c/c-JPR5YHB4.js";var Pt,lo=L(()=>{"use strict";be();qe();Tt();pe();Hr();Pt=({editorState:e,method:n})=>{let o=K(e,"LETTER_SPACING"),t=o&&o.length?parseFloat(o[0]):0,r=de({editorState:e}),i=on()||{project:[],global:[]},a=[...i.project,...i.global].find(d=>d.name===r),m=!!r&&ke(a?.cssProperties.letterSpacing,!0),p=t||m||0,l=n==="decrease"?-1:1;return he({key:"LETTER_SPACING",value:ao(p+.2*l,2),editorState:e})}});var Rt,co=L(()=>{"use strict";be();Re();pe();Rt=({editorState:e,method:n})=>{let o=K(e,"FONT_SIZE"),t=o&&o.length?parseInt(o[0]):Y.fontSize,r=n==="decrease"?-1:1;return he({key:"FONT_SIZE",value:t+r,editorState:e})}});function Me(e){return!e.isFolder}function uo(e){return!!e.isFolder}function Os({all:e,allProjects:n,excluded:o,selectedUser:t,me:r}){let s=(o||[]).map(i=>i._id);return t&&typeof t=="object"&&t._id&&s.push(t._id),e.reduce((i,a)=>{if(a.email===r.email)return i;let m=Wr(a,n)+Kr(a.folderIds||[],n).length,p={...a,projectsCount:m},l=i.map(u=>u._id);return!a.isPending&&![...s,...l].includes(a._id)?[...i,p]:i},[])}function Nr(e){return e.reduce((n,o)=>Me(o)?[...n,o.num_id]:n,[])}function Fs(e){return e.reduce((n,o)=>uo(o)?[...n,o._id]:n,[])}function Wr(e,n){let o=Nr(n);return e.projects?e.projects.filter(t=>!t.isArchived).length:e.sharesAll?n.length:e.projectNumIds.filter(t=>o.includes(t)).length}function Ls({projects:e,allTeammates:n,me:o}){return e.length?n.filter(t=>t.email===o.email?!1:!t.projects&&(t.sharesAll&&e.every(r=>Me(r))||e.every(r=>Me(r)&&(t.projectNumIds||[]).includes(r.num_id)||Me(r)&&!!r.folder&&(t.folderIds||[]).includes(r.folder)||uo(r)&&(t.folderIds||[]).includes(r._id)))):[]}function Us(e,n){let o=Yt([...e,...n],"email");return o.map(t=>{if(!t.isPending)return t;let r=o.find(s=>s.email===t.email&&s._id!==t._id);return r?{...t,name:r.name,pic:r.pic}:t})}function Kr(e,n){return e?n.filter(o=>Me(o)&&o.folder&&e.includes(o.folder)).map(o=>o.num_id):[]}function _s(e){return e&&e.plan_limits&&e.plan_limits.contributors||0}function Ms(e){return e.filter(n=>n.sharesAll||n.projectNumIds&&n.projectNumIds.length||n.folderIds&&n.folderIds.length)}function fo({projectNumId:e,projectFolderId:n,folderId:o,teammate:t}){return typeof e=="number"&&t.projectRoles?.hasOwnProperty(e)?t.projectRoles[e]:typeof o=="string"&&t.folderRoles?.hasOwnProperty(o)?t.folderRoles[o]:typeof n=="string"&&t.folderRoles?.hasOwnProperty(n)?t.folderRoles[n]:null}function Ds({items:e=[],roles:n={},newItems:o,newRole:t}){let r={},s=[];for(let i of e)n.hasOwnProperty(i)&&(r[i]=n[i],s.push(i));if(t&&o?.length)for(let i of o)r[i]=t,s.includes(i)||s.push(i);return{roles:r,items:s}}var po=L(()=>{"use strict";Gt()});var mo,me,Ot=L(()=>{"use strict";po();mo="projectRoles",me={rolesList:[{name:"member",description:"Layout unlocked"},{name:"editor",description:"Layout locked",secondaryDescription:"Enables non-designers to make changes safely"}],isPermissionAllowed(e){return window.RM?.constructorRouter?.mag?.isPermissionAllowed?.(e)??!0},checkSelfRoleChanged({teammate:e,isOwner:n,projectNumId:o,userEmail:t,team:r}){if(n&&e.email===t){let s=e.projectRoles?.[o],i=r?.find(a=>a.email===t)?.projectRoles?.[o];return s!==i}return!1},getRoleForProject({team:e,projectNumId:n,userEmail:o}){let t=e.find(r=>r.email===o);if(t){let r=fo({teammate:t,projectNumId:n});if(r)return r}return null},getCurrentRole(){return window.RM?.constructorRouter?.mag?.roleName??"member"},getAllProjectRoles(){let e={};try{let n=sessionStorage.getItem(mo);e=n?JSON.parse(n):{}}catch(n){console.log(n)}return e},saveProjectRole(e,n){try{let o=me.getAllProjectRoles();o[e]=n,sessionStorage.setItem(mo,JSON.stringify(o))}catch(o){console.log(o)}},getCurrentProjectRole(e){return me.getAllProjectRoles()[e]||"member"},getRoleForAnalytics(e){let n=me.getCurrentRole();return e?"owner":n==="editor"?"collaborator_locked_layout":"collaborator_unlocked_layout"}}});var go=L(()=>{"use strict"});var De=L(()=>{"use strict"});var yo=L(()=>{"use strict"});var Be,Ft=L(()=>{"use strict";Be={COUNT_OF_ACTIONS_IN_PROJECT:"rm_count_of_actions_in_project"}});var ho,So=L(()=>{"use strict";Ft();ho=(e=null)=>{if(window&&window.sessionStorage){let n=e,o=0;if(!n){let r=window.sessionStorage.getItem(Be.COUNT_OF_ACTIONS_IN_PROJECT);try{n=r?JSON.parse(r):null}catch{return 0}}try{for(let t in n)if(n.hasOwnProperty(t)){let r=n[t];o+=r}}catch{return o}return o}else return 0}});function P(e){if(window&&window.sessionStorage){let o=window.sessionStorage.getItem(Be.COUNT_OF_ACTIONS_IN_PROJECT),t=null;try{t=o?JSON.parse(o):null}catch{return}let r=!1?e.toLowerCase():"action";t&&t[r]?t[r]++:(t||(t={}),t[r]=1);let s=ho(t);s%100===0&&Jt.trigger("send-actions-made-data",s),window.sessionStorage.setItem(Be.COUNT_OF_ACTIONS_IN_PROJECT,JSON.stringify(t))}}var st=L(()=>{"use strict";go();yr();De();yo();Ft();So()});var it,_,To,xo,Ut=L(()=>{"use strict";it=N(Ge());pe();Vn();Ct();lo();co();Cr();pn();be();Re();Pr();Ot();st();De();ht();_=({event:e,keyCode:n,ctrlOrCmd:o=!1,shift:t=!1,alt:r=!1})=>{let s=it.KeyBindingUtil.usesMacOSHeuristics();return n===e.keyCode&&t===e.shiftKey&&r===e.altKey&&(s?o===e.metaKey:o===e.ctrlKey)},To=e=>{let n=me.isPermissionAllowed("TextCanChangeTypography"),o=me.isPermissionAllowed("TextCanChangeAlign"),t=me.isPermissionAllowed("TextCanChangeAdvancedTypography");if(_({event:e,keyCode:32,alt:!0}))return U("constructor.startTrackingUserActionsAcrossWidgetsAndInterface")&&P("shortcut_alt_space"),"InsertNbsp";if(_({event:e,keyCode:32,alt:!0,ctrlOrCmd:!0}))return U("constructor.startTrackingUserActionsAcrossWidgetsAndInterface")&&P("shortcut_ctrl_alt_space"),"InsertNbsp";if(_({event:e,keyCode:32,alt:!0,ctrlOrCmd:!0,shift:!0}))return U("constructor.startTrackingUserActionsAcrossWidgetsAndInterface")&&P("shortcut_ctrl_alt_shift_space"),"InsertThinsp";if(_({event:e,keyCode:32,alt:!0,shift:!0}))return U("constructor.startTrackingUserActionsAcrossWidgetsAndInterface")&&P("shortcut_alt_shift_space"),"InsertEnsp";if(_({event:e,keyCode:9}))return U("constructor.startTrackingUserActionsAcrossWidgetsAndInterface")&&P(`shortcut_${e.key}`),"IncreaseIndent";if(_({event:e,keyCode:9,shift:!0}))return U("constructor.startTrackingUserActionsAcrossWidgetsAndInterface")&&P(`shortcut_${e.key}_shift`),"DecreaseIndent";if(_({event:e,keyCode:65,ctrlOrCmd:!0,shift:!0}))return U("constructor.startTrackingUserActionsAcrossWidgetsAndInterface")&&P("shortcut_a_ctrl_shift"),"SelectParagraph";if(U("constructor.startTrackingUserActionsAcrossWidgetsAndInterface")&&(_({event:e,keyCode:90,ctrlOrCmd:!0})&&P("shortcut_z_ctrl"),_({event:e,keyCode:90,ctrlOrCmd:!0,shift:!0})&&P("shortcut_z_ctrl_shift"),_({event:e,keyCode:65,ctrlOrCmd:!0})&&P("shortcut_a_ctrl"),_({event:e,keyCode:68,ctrlOrCmd:!0})&&P("shortcut_d_ctrl"),_({event:e,keyCode:68,ctrlOrCmd:!0,shift:!0})&&P("shortcut_d_ctrl_shift")),_({event:e,keyCode:84,alt:!0,ctrlOrCmd:!0}))return U("constructor.startTrackingUserActionsAcrossWidgetsAndInterface")&&P("shortcut_t_ctrl_alt"),"ToggleTypographyPanel";if(_({event:e,keyCode:75,ctrlOrCmd:!0}))return U("constructor.startTrackingUserActionsAcrossWidgetsAndInterface")&&P("shortcut_k_ctrl"),"ToggleLinkPanel";if(n){if(_({event:e,keyCode:38,alt:!0}))return U("constructor.startTrackingUserActionsAcrossWidgetsAndInterface")&&P(`shortcut_${e.key}_alt`),"DecreaseLineHeight";if(_({event:e,keyCode:40,alt:!0}))return U("constructor.startTrackingUserActionsAcrossWidgetsAndInterface")&&P(`shortcut_${e.key}_alt`),"IncreaseLineHeight";if(_({event:e,keyCode:37,alt:!0}))return U("constructor.startTrackingUserActionsAcrossWidgetsAndInterface")&&P(`shortcut_${e.key}_alt`),"DecreaseLetterSpacing";if(_({event:e,keyCode:39,alt:!0}))return U("constructor.startTrackingUserActionsAcrossWidgetsAndInterface")&&P(`shortcut_${e.key}_alt`),"IncreaseLetterSpacing";if(_({event:e,keyCode:190,ctrlOrCmd:!0,shift:!0}))return U("constructor.startTrackingUserActionsAcrossWidgetsAndInterface")&&P("shortcut_>_ctrl_shift"),"IncreaseFontSize";if(_({event:e,keyCode:188,ctrlOrCmd:!0,shift:!0}))return U("constructor.startTrackingUserActionsAcrossWidgetsAndInterface")&&P("shortcut_<_ctrl_shift"),"DecreaseFontSize"}if(o){if(_({event:e,keyCode:76,ctrlOrCmd:!0,shift:!0}))return U("constructor.startTrackingUserActionsAcrossWidgetsAndInterface")&&P("shortcut_l_ctrl_shift"),"AlignLeft";if(_({event:e,keyCode:82,ctrlOrCmd:!0,shift:!0}))return U("constructor.startTrackingUserActionsAcrossWidgetsAndInterface")&&P("shortcut_r_ctrl_shift"),"AlignRight";if(_({event:e,keyCode:67,ctrlOrCmd:!0,shift:!0}))return U("constructor.startTrackingUserActionsAcrossWidgetsAndInterface")&&P("shortcut_c_ctrl_shift"),"AlignCenter"}if(t){if(_({event:e,keyCode:66,ctrlOrCmd:!0}))return U("constructor.startTrackingUserActionsAcrossWidgetsAndInterface")&&P("shortcut_b_ctrl"),"ToggleBold";if(_({event:e,keyCode:73,ctrlOrCmd:!0}))return U("constructor.startTrackingUserActionsAcrossWidgetsAndInterface")&&P("shortcut_i_ctrl"),"ToggleItalic";if(_({event:e,keyCode:85,ctrlOrCmd:!0}))return U("constructor.startTrackingUserActionsAcrossWidgetsAndInterface")&&P("shortcut_u_ctrl"),"ToggleUnderline"}return(0,it.getDefaultKeyBinding)(e)},xo=({action:e,editorState:n,workspace:o})=>{if(e==="InsertNbsp")return{status:"handled",editorState:ve({editorState:n,text:wn})};if(e==="InsertEnsp")return{status:"handled",editorState:ve({editorState:n,text:String.fromCharCode(8194)})};if(e==="InsertThinsp")return{status:"handled",editorState:ve({editorState:n,text:String.fromCharCode(8201)})};if(e==="IncreaseIndent"){let t=It({editorState:n,method:"increase"});if(t)return{status:"handled",editorState:t}}if(e==="backspace"||e==="DecreaseIndent"){let t=It({editorState:n,method:"decrease"});if(t)return{status:"handled",editorState:t}}if(e==="DecreaseLineHeight"){let t=xt({editorState:n,method:"decrease"});if(t)return{status:"handled",editorState:t}}if(e==="IncreaseLineHeight"){let t=xt({editorState:n,method:"increase"});if(t)return{status:"handled",editorState:t}}if(e==="IncreaseLetterSpacing")if(n.getSelection().isCollapsed()){let t=Et(n,"next");if(t)return{status:"handled",editorState:t}}else{let t=Pt({editorState:n,method:"increase"});if(t)return{status:"handled",editorState:t}}if(e==="DecreaseLetterSpacing")if(n.getSelection().isCollapsed()){let t=Et(n,"prev");if(t)return{status:"handled",editorState:t}}else{let t=Pt({editorState:n,method:"decrease"});if(t)return{status:"handled",editorState:t}}if(e==="ToggleTypographyPanel"){let t=o.controls.findControl("text_typography");if(t)return t.onClick.apply(t),{status:"handled",editorState:n}}if(e==="ToggleLinkPanel"){let t=o.controls.findControl("text_link");if(t)return t.onClick.apply(t),{status:"handled",editorState:n}}if(e==="IncreaseFontSize")return{status:"handled",editorState:Rt({editorState:n,method:"increase"})};if(e==="DecreaseFontSize")return{status:"handled",editorState:Rt({editorState:n,method:"decrease"})};if(e==="AlignLeft"||e==="AlignRight"||e==="AlignCenter"){let t=e==="AlignLeft"?"align-left":e==="AlignRight"?"align-right":"align-center";return{status:"handled",editorState:fn({editorState:n,align:t})}}if(e==="SelectParagraph")return{status:"handled",editorState:Fn(n)};if(e==="ToggleBold"){let t=K(n,"FONT_WEIGHT");return{status:"handled",editorState:he({editorState:n,key:"FONT_WEIGHT",value:t&&t[0]==="700"?Y.fontWeight:"700"})}}if(e==="ToggleItalic"){let t=K(n,"FONT_STYLE");return{status:"handled",editorState:he({editorState:n,key:"FONT_STYLE",value:t&&t[0]==="italic"?Y.fontStyle:"italic"})}}if(e==="ToggleUnderline"){let t=K(n,"DECORATION");return{status:"handled",editorState:he({editorState:n,key:"DECORATION",value:t&&t[0]==="underline"?"none":"underline"})}}}});var Co,bo=L(()=>{"use strict";Or();Re();be();qn();kt();pe();Co=$n({htmlToEntity:(e,n,o)=>{if(e==="a")return o(Ze,"MUTABLE",Yn(n))},htmlToStyle:(e,n,o)=>e==="b"?o.add(wt("FONT_WEIGHT","700")):e==="i"?o.add(wt("FONT_STYLE","italic")):o,htmlToBlock:(e,n)=>{if(e==="p"||e.match(/h\d/))return{type:"unstyled",data:Gn(n,{ignore:{lineHeight:!0,textStyles:!0}})}}})});var ie,Eo,vo,_t,ko,Vr,Yr,Gr,wo,Io,Jr,Ao,Po,Ro=L(()=>{"use strict";ie=N(Ge()),Eo=N(Tr()),vo=N(xr());pe();qn();kt();Ut();En();st();De();ht();bo();_t="data-draftjs-conductor-fragment",ko='[data-contents="true"] [contenteditable="false"]',Vr=e=>{let{anchorNode:n,focusNode:o}=e;if(!n||!o)return!1;let t=n instanceof Element?n:n.parentElement,r=o instanceof Element?o:o.parentElement,s=t&&t.closest(ko),i=r&&r.closest(ko);return s&&i&&(s.contains(i)||i.contains(s))},Yr=(e,n)=>{let{selectionState:o}=(0,vo.default)(e,n),t=(0,Eo.default)(e.getCurrentContent(),o);return t.every(s=>!!(s&&s.getText().length===0))?null:t},Gr=(e,n,o)=>{let t=(o||window).getSelection();if(!n.clipboardData||!t||!e||t.rangeCount===0||Vr(t)||!e.current?._latestEditorState)return;let r=Yr(e.current?._latestEditorState,e.current?.editor);if(r){U("constructor.startTrackingUserActionsAcrossWidgetsAndInterface")&&(n.type==="copy"?P("shortcut_c_ctrl"):n.type==="cut"&&P("shortcut_x_ctrl"));let s=ie.ContentState.createFromBlockArray(r.toArray()),i=JSON.stringify((0,ie.convertToRaw)(s)),a=document.createElement("div");a.appendChild(t.getRangeAt(0).cloneContents()),a.setAttribute(_t,i),a.setAttribute("style","white-space: pre-wrap;"),n.clipboardData.setData("text/plain",t.toString()),n.clipboardData.setData("text/html",a.outerHTML),n.preventDefault()}},wo=(e,n)=>{let o=e.current?.editor,t=r=>{Gr(e,r,n)};return o&&o.addEventListener("copy",t),o&&o.addEventListener("cut",t),{unregister(){o&&o.removeEventListener("copy",t),o&&o.removeEventListener("cut",t)}}},Io=(e,n)=>{let o=e.current,t=o?.editor;if(!o||!t)return;let r=!1,s=a=>{r=_({event:a,keyCode:86,ctrlOrCmd:!0,shift:!0})},i=a=>{a.stopPropagation(),a.preventDefault(),a.cancelBubble=!0,a.returnValue=!1;let m=a.clipboardData?.getData("text/plain"),p=a.clipboardData?.getData("text/html");m&&o.props?.handlePaste&&(U("constructor.startTrackingUserActionsAcrossWidgetsAndInterface")&&(r?P("shortcut_v_ctrl_shift"):P("shortcut_v_ctrl")),o.props.handlePaste(m,p,o?._latestEditorState,n.forceCleanText?!0:r))};return n.forceCleanText||t.addEventListener("keydown",s,!0),t.addEventListener("paste",i,!0),{unregister(){n.forceCleanText||t.removeEventListener("keydown",s,!0),t.removeEventListener("paste",i,!0)}}},Jr=e=>{let o=new DOMParser().parseFromString(e,"text/html").querySelector(`[${_t}]`);if(o){let t=o.getAttribute(_t);try{if(t){let r=JSON.parse(t);if(r)return(0,ie.convertFromRaw)(r)}}catch{return null}}return null},Ao=(e="",n,o)=>{let t=n.getSelection(),r=!t.isCollapsed(),s=n.getCurrentContent(),i=Ue(n),m=s.getBlockForKey(i[0]).getEntityAt(t.getStartOffset()),p="Text";return r&&!m&&et(e,o)&&(p="Link"),p},Po=({text:e,html:n,editorState:o,pastedWithShift:t})=>{let r=tt(o),s=o.getCurrentContent(),i=Ue(o),m=(()=>{let p=!t,l=i.some(u=>{let d=s.getBlockForKey(u);return!!de({editorState:o,block:d})});if(p&&!l){let u=n?Jr(n):void 0,d=n?Co(Jn(n)):void 0;if(u||d){let k=u?.getBlockMap()||d?.getBlockMap();if(k){let C=ie.Modifier.replaceWithFragment(s,r,Wn(o,Nn({originStyles:o.getCurrentInlineStyle(),blockMap:k})));return ie.EditorState.push(o,C,"insert-fragment")}}}return e?ve({editorState:o,text:e}):o})();if(i.length===1){let p=s.getBlockForKey(i[0]),l=p.getEntityAt(r.getStartOffset());if(l&&s.getEntity(l)?.getType()===Ze){let u=0,d=0;p.findEntityRanges(T=>T.getEntity()===l,(T,w)=>{u=T,d=w});let k=e?.length||0,C=r.getStartOffset(),c=r.getEndOffset(),f=Math.abs(c-C),y=r.merge({anchorOffset:u,focusOffset:d+k-f});m=Hn(m,y,l),m=ie.EditorState.push(o,m.getCurrentContent(),"apply-entity");let S=C+k,g=r.merge({anchorOffset:S,focusOffset:S});m=Ee(m,g)}}return m}});var ue,Mt,qr,Ne,Xr,Oo,at=L(()=>{"use strict";ue=N(ce()),Mt=N(Qt());Zt();qt();wr();we();Ye();oe();qr=R.withComponent(Ce("iframe")``),Ne=(0,ue.createContext)({}),Xr=(0,ue.forwardRef)(({children:e,contentDidMount:n,...o},t)=>{let[r,s]=(0,ue.useState)(),[i,a]=(0,ue.useState)(null),m=()=>{if(i){let d=i.contentDocument,k=i.contentWindow;if(d&&k){let C=d.querySelector("html");s({document:d,window:k,root:C}),n&&n()}}},{body:p,head:l}=(0,ue.useMemo)(()=>r&&r.root?{body:r.root.querySelector("body"),head:r.root.querySelector("head")}:{},[r&&r.root]),u=(0,ue.useMemo)(()=>ze({key:"frame-theme",container:r?.document.head}),[r&&r.document]);return h(qr,{ref:Tn(t,a),onLoad:m,frameBorder:"0",referrerPolicy:"origin",height:"100%",width:"100%",overflow:"hidden",border:"none",display:"block",srcDoc:"<!DOCTYPE html><html><head></head><body></body></html>",...o,children:r&&r.root?V(ye,{children:[o.head&&l&&(0,Mt.createPortal)(o.head,l),p&&(0,Mt.createPortal)(h(Ne.Provider,{value:r,children:h(Ve,{value:u,children:h(R,{width:"100%",height:"100%",children:e})})}),p)]}):null})}),Oo=Xr});function zi({permission:e,children:n}){let o=We(e);return h(Fo,{disabled:!o,children:n})}function We(e){return me.isPermissionAllowed(e)}var Fo,Dt=L(()=>{"use strict";Ye();we();Ot();oe();Fo=Ce(R)`
  &[disabled] {
    opacity: 0.4 !important;
    pointer-events: all !important;
    cursor: default !important;

    * {
      user-select: none !important;
      pointer-events: none !important;
      cursor: default !important;
    }

    input::selection {
      background: transparent !important;
    }
  }
`;Fo.displayName="PermissionContainer"});var Lo=L(()=>{"use strict";Dt()});var Uo,_o,Zr,Qr,es,Mo=L(()=>{"use strict";Uo=N(Ge()),_o=(e,n)=>{let o=e.current,t=o?.editor;if(!o||!t)return;let r=()=>{let i=t;if(i){let a=new MouseEvent("mouseup",{view:n,bubbles:!0,cancelable:!0});i.dispatchEvent(a)}},s=i=>{i.stopPropagation(),i.preventDefault(),i.cancelBubble=!0,i.returnValue=!1,o._dragCount=0,o.exitCurrentMode();let a=es(i);if(a){if(o.props?.handleDrop){let m=o._internalDrag?"internal":"external";o.props?.handleDrop(a,{},m)}o._internalDrag=!1,r()}};return t.addEventListener("drop",s,!0),{unregister(){t.removeEventListener("drop",s,!0)}}},Zr=e=>!e||!e.ownerDocument?document:e.ownerDocument,Qr=e=>{let n="data-offset-key",o=e.nodeType===Node.TEXT_NODE&&e.parentElement||e;if(!o)return null;let t=o.closest(`[${n}]`);if(!t)return null;let s=t.getAttribute(n)?.split("-");return s&&s.length?s[0]:null},es=e=>{let n=null,o=null,t=Zr(e.currentTarget);if(typeof t.caretRangeFromPoint=="function"){let i=t.caretRangeFromPoint(e.x,e.y);n=i?.startContainer,o=i?.startOffset}else if(e.rangeParent)n=e.rangeParent,o=e.rangeOffset;else return null;let r=Qr(n);return r?new Uo.SelectionState({anchorKey:r,anchorOffset:o,focusKey:r,focusOffset:o,isBackward:!1,hasFocus:!1}):null}});function ts(e,n,o){return e<n?n:e>o?o:e}function Do(e,n){return n>=0&&e>=0&&e<n}function lt(e,n,o,t){return Number(ts(e,n,o).toFixed(t))}function Ht(e,n,o){return e==="+"?n+o:n-o}function Bo(e,n,o,t,r=!1){let s=[e>o,Bt(e)>t];return r&&s.push(e<n),s.every(i=>!i)}function Nt(e){return e=Number(e),Number.isFinite(e)&&!Number.isNaN(e)}function Ho(e){return e===""||e.length===1&&e[0]==="-"?!0:!!e.endsWith(".")}function No(e){return e.replace(",",".")}function Wo(e){let n=e.trim();function o(t,r){return t===r}for(let t=0;t<n.length;t++){let r=n[t];if(r==="."||r===","||r===""||r==="-"){let s=n[t+1];(o(r,s)||r==="-"&&t>0)&&(n=n.slice(0,t)+n.slice(t+1),t--)}}return n}function Ko(e){return e===""||(e=e.trim(),e[0]==="."&&(e="0"+e)),e}var Bt,jo=L(()=>{"use strict";Bt=e=>e%1?e.toString().split(".")[1].length:0});function $o({ref:e,value:n,disabled:o=!1}){let[t,r]=(0,ct.useState)("");return(0,ct.useEffect)(()=>{e.current&&!o&&r(ns(e.current,n))},[n,o]),[o?"":t]}var ct,ns,zo=L(()=>{"use strict";ct=N(ce());Cn();ns=(e,n)=>{if(typeof document<"u"&&e){let o=typeof n=="number"?n.toString():n,t=document.createElement("span");document.body.appendChild(t);let r=getComputedStyle(e).getPropertyValue("font-size");r&&(t.style.fontSize=r.toString()),t.style.font=Qe.fonts.main,t.style.position="absolute",t.style.left="-9999px",t.style.margin="0",t.style.width="auto",t.style.whiteSpace="pre",t.innerHTML=o;let s=Math.ceil(t.clientWidth);return s=Math.ceil(s/2)*2+2,t.remove(),s+"px"}return""}});function os(e,n){return{...e,...n}}function Vo(e,n,o){let t=n.map(r=>{let s=os(o,r.options);return e.addEventListener(r.eventName,r.fn,s),function(){e.removeEventListener(r.eventName,r.fn,s)}});return function(){t.forEach(r=>{r()})}}var Yo=L(()=>{"use strict"});var Se,rs,ss,dt,Go=L(()=>{"use strict";Se=N(ce()),rs=typeof window<"u"?Se.useLayoutEffect:Se.useEffect,ss=e=>{let n=(0,Se.useRef)(e);return rs(()=>{n.current=e}),(0,Se.useCallback)((...o)=>{let t=n.current;return t?.(...o)},[])},dt=ss});function is(e,n){return Math.abs(n.x-e.x)>=Jo||Math.abs(n.y-e.y)>=Jo}function as({getPhase:e,setPhase:n,getActions:o,completed:t,disableClickThreshold:r}){return[{eventName:"mousemove",fn:s=>{let{clientX:i,clientY:a}=s,m={x:i,y:a},p=e(),l=o();if(p.type==="MOVING"){s.preventDefault(),l?.move(m,s);return}let u=p.point;!r&&!is(u,m)||(s.preventDefault(),n({type:"MOVING",point:m}),l?.start(s))}},{eventName:"mouseup",fn:s=>{let i=e(),a=o();if(i.type!=="MOVING"){t();return}s.preventDefault(),t(),a?.end(s)}}]}function qo({disabled:e=!1,onMove:n,onMoveStart:o,onMoveEnd:t,disableClickThreshold:r=!1}={}){let[s,i]=(0,j.useState)({type:"IDLE",point:{x:0,y:0}}),a=j.default.useRef(s),m=j.default.useRef(),p=(0,j.useRef)(),l=dt(n),u=dt(o),d=dt(t);(0,j.useEffect)(()=>{a.current=s},[s]);let k=(0,j.useMemo)(()=>({move:(f,y)=>{l({event:y,offset:{x:f.x-a.current.point.x,y:f.y-a.current.point.y}})},start:f=>u(f),end:f=>d(f)}),[]);(0,j.useEffect)(()=>{m.current=k},[k]);let C=(0,j.useCallback)(()=>{a.current.type!=="IDLE"&&(i({type:"IDLE",point:{x:0,y:0}}),p.current?.())},[]),c=(0,j.useCallback)(f=>{if(e){typeof p.current=="function"&&p.current();return}if(f.ctrlKey||f.metaKey||f.shiftKey||f.altKey)return;let y={x:f.clientX,y:f.clientY};i({type:"PENDING",point:y});let S=as({completed:C,getPhase:()=>a.current,setPhase:i,getActions:()=>m.current,disableClickThreshold:r});p.current=Vo(window,S,{capture:!0,passive:!1})},[C,e]);return(0,j.useLayoutEffect)(()=>function(){p.current?.()},[]),(0,j.useMemo)(()=>({moving:s.type==="MOVING",start:c}),[c,s])}var j,Jo,Xo=L(()=>{"use strict";j=N(ce());Yo();Go();Jo=5});function Ke(e,n){return o=>{n&&n(o),e&&e(o)}}function er({direction:e,labelRef:n,...o}={}){let t=qo(o);return(0,G.useEffect)(()=>{if(!o.disabled)return n?.current&&e&&(n.current.style.setProperty("cursor",Qo[e]),n.current.style.setProperty("user-select","none"),n.current.addEventListener("mousedown",t.start)),()=>{n?.current&&(n.current.style.removeProperty("cursor"),n.current.style.removeProperty("user-select"),n.current.removeEventListener("mousedown",t.start))}},[t.start,o.disabled,e]),{...t,style:{cursor:o.disabled||!e?"initial":Qo[e]}}}var G,Zo,ls,cs,Wt,Qo,tr=L(()=>{"use strict";G=N(ce());Ye();Cn();Ir();Lr();_r();Mr();jo();zo();Xo();oe();Zo="Mixed";ls=Ce(no,{excludeProps:["contextDetails"]})`
  margin: 0;
  padding: 0;
  appearance: textfield;
  border-bottom: none !important;
  font-family: ${Qe.fonts.main};

  &::-webkit-outer-spin-button,
  &::-webkit-inner-spin-button {
    appearance: none;
  }
`,cs="NumericInput",Wt=(0,G.forwardRef)((e,n)=>{let{value:o,isMixedValue:t=!1,step:r=1,shiftStep:s=10,direction:i="y",moveSpeed:a=3,autoWidth:m=!1,textStyle:p="subheading",min:l=Number.NEGATIVE_INFINITY,max:u=Number.POSITIVE_INFINITY,disableArrowInput:d=!1,text:k,disabled:C,disableScrubbing:c=!1,labelRef:f,floating:y,onChange:S,onScrubbing:g,onScrubbingStart:T,onScrubbingEnd:w,...O}=e,[E,x]=(0,G.useState)(String(o)),[A,I]=(0,G.useState)(!1),B=(0,G.useRef)(0),H=(0,G.useRef)(null),$=xn(n,H),[Z]=$o({ref:H,value:t?Zo:E,disabled:!m}),{moving:re,start:te,style:ge}=er({disabled:c||t||C,direction:i,labelRef:f,onMove:z,onMoveStart:M,onMoveEnd:q});(0,G.useEffect)(()=>{x(String(o))},[o]);let se=(0,G.useMemo)(()=>typeof y=="boolean"?y?1:0:typeof y=="number"?y:r!==void 0?Bt(r):0,[r,y]);function ae(F,D=!1){let X=Number(F),ne=Do(X,l)&&!D;return Bo(X,l,u,se,D||!ne)||(X=lt(X,l,u,se)),{isValid:Nt(X)&&!ne,result:X}}function Q(F,D,X){let{isValid:ne,result:fe}=ae(F,X?.fullValidate);x(fe.toString()),S&&ne&&fe!==o&&S({value:fe,oldValue:o},D)}function xe(F){if(C)return;let D=No(F.target.value),X=Wo(D),ne=Ko(X),fe=Ho(X),zt=Nt(ne);!fe&&zt?Q(ne,F):(fe||zt)&&x(ne)}function Pe(){I(!0)}function je(F){if(I(!1),!t){let D=lt(o,l,u,se);Q(D,F,{fullValidate:!0})}}function $e(F){if(F.code==="ArrowUp"||F.code==="ArrowDown"||F.code==="Enter"){F.preventDefault();let D=F.shiftKey?s*r:r;F.code==="ArrowUp"?Q(Ht("+",o,D),F,{fullValidate:!0}):F.code==="ArrowDown"&&Q(Ht("-",o,D),F,{fullValidate:!0}),F.code==="Enter"&&H.current&&H.current.blur()}}function gt(F){let D=F.target;D.selectionStart===D.selectionEnd&&D.select()}function yt(F){F.target.setSelectionRange(0,0);let D=f?.current?.contains(H.current);!t&&!D&&te(F.nativeEvent)}function M(){T&&T(o),B.current=0}function q(){if(f&&!t){let F=lt(o,l,u,se);F!==o&&Q(F,void 0,{fullValidate:!0})}w&&w(o),B.current=0}function z({offset:F}){let D=F[i];if(i==="y"&&(D=-D),D){let X=Math.round(D/a),ne=(X-B.current)*r;if(!t){let fe=ne+o;fe!==o&&Q(fe,void 0,{fullValidate:!0})}g&&ne!==0&&g(ne,{mixed:!!t}),B.current=X}}let le={value:E,disabled:C,height:"fit-content",color:"inherit",...O,type:"text",onChange:xe,onBlur:Ke(je,e.onBlur),onFocus:Ke(Pe,e.onFocus),onMouseUp:Ke(gt,e.onMouseUp),onMouseDown:Ke(yt,e.onMouseDown)};return d||(le.onKeyDown=Ke($e,e.onKeyDown)),k!==void 0&&!A&&(le.value=k),t||(le.style={...ge,...O?.style}),t&&(le.value=Zo,A&&(le.value="")),Z&&(le.width=Z),V(G.Fragment,{children:[h(ls,{caretColor:re?"transparent":"auto",textStyle:p,...le,ref:$}),re?h(ro,{children:h(so,{role:"presentation",backgroundColor:"transparent",zIndex:99999,style:ge,userSelect:"none"})}):null]})});Wt.displayName=cs;Qo={x:"ew-resize",y:"ns-resize"}});var nr,or=L(()=>{"use strict";tr();nr=Wt});function fs({editable:e,children:n,left:o,top:t,right:r,bottom:s,onChange:i,changedPaddings:a={}}){let{isPaddingsEnabled:m,setIsPaddingsEnabled:p}=(0,b.useContext)(ft),l=(0,b.useRef)(null).current,u=(0,b.useCallback)(T=>{l=T,p(!0)},[]),d=(0,b.useCallback)(T=>{(!l||l===T)&&p(!1)},[l]),k=(0,b.useRef)(null),{height:C}=_e(k),c=(0,b.useMemo)(()=>C<Ae,[C]),f=(0,b.useCallback)(T=>i({top:T}),[i]),y=(0,b.useCallback)(T=>i({left:T}),[i]),S=(0,b.useCallback)(T=>i({right:T}),[i]),g=(0,b.useCallback)(T=>i({bottom:T}),[i]);return V(R,{position:"relative",style:{paddingTop:t,paddingLeft:o,paddingRight:r,paddingBottom:s},children:[e&&h(ye,{children:V(R,{contentEditable:!1,display:"inline",opacity:e?1:0,visibility:e?"visible":"hidden",userSelect:"none",children:[h(ut,{isSmall:c,isChanged:a?.top,from:"top",value:t,marginLeft:o,marginRight:r,onChange:f,onStart:u,onStop:d}),h(ut,{isSmall:c,isChanged:a?.left,from:"left",value:o,marginTop:t,marginBottom:s,onChange:y,onStart:u,onStop:d}),h(ut,{isSmall:c,isChanged:a?.right,from:"right",value:r,marginTop:t,marginBottom:s,onChange:S,onStart:u,onStop:d}),h(ut,{isSmall:c,isChanged:a?.bottom,from:"bottom",value:s,marginLeft:o,marginRight:r,onChange:g,onStart:u,onStop:d})]})}),h(R,{ref:k,className:"editor-block-wrapper",userSelect:m?"none":void 0,children:n})]})}var b,rr,ds,ft,Ae,Kt,us,ut,sr,jt=L(()=>{"use strict";b=N(ce()),rr=N(Qt());Zt();qt();ir();we();at();oo();or();oe();ds=ze({key:"padding-frame-theme",container:typeof document<"u"?document.head:void 0}),ft=(0,b.createContext)({}),Ae=43,Kt=2,us=(0,b.memo)(({isActive:e,isSmall:n,from:o,value:t,position:r,onChange:s,disabled:i})=>{let a=window.RM.constructorRouter.zoom.getZoom(),m=o==="top"||o==="bottom",p=n&&!m,l=(0,b.useRef)(null),{width:u,height:d}=_e(l),k=(0,b.useMemo)(()=>(m?u:d)*a,[m,u,d,a]),C=l&&l.current?l.current.getBoundingClientRect():{x:0,y:0},c=(0,b.useMemo)(()=>p?10:o==="top"?"22px 22px 0 0":o==="right"?"0 22px 22px 0":o==="left"?"22px 0 0 22px":"0 0 22px 22px",[p,o]),f=(0,b.useMemo)(()=>{let E=k-Ae,x=r*a-Ae/2;return Math.max(0,x<=E?x:E)},[r,k,a]),{height:y,width:S}=(0,b.useMemo)(()=>({height:p?20:Ae,width:p?38:m?Ae:47}),[p,Ae,m]),{ref:g}=(0,b.useContext)($t),T=g&&g.current?g.current.getBoundingClientRect():{x:0,y:0},w=(0,b.useMemo)(()=>document.getElementById("paddings-input-portal"),[]),O=h(R,{display:"flex",position:"relative",justifyContent:p?"flex-start":"flex-end",flexDirection:m?"row":"column",style:{position:"absolute",...m?{left:f+T.x+C.x*a,top:T.y+C.y*a-(o==="top"?y:0)}:{top:f+T.y+C.y*a,left:T.x+C.x*a-(o==="left"?S:0)}},children:h(R,{display:"flex",backgroundColor:"blue",width:S,height:y,borderRadius:c,alignItems:"center",justifyContent:"center",zoom:"var(--workspace-inverse-zoom)",transform:"scale(var(--workspace-zoom))",transformOrigin:"left top",children:h(nr,{min:0,value:t,color:"white",fontSize:14,fontWeight:600,placeholder:"0",textAlign:"center",disabled:i,onChange:({value:E})=>s(E)})})});return h(Ve,{value:ds,children:V(ye,{children:[h(R,{ref:l,width:"100%",height:"100%"}),e&&w?rr.default.createPortal(O,w):null]})})}),ut=(0,b.memo)(({from:e,isChanged:n,onChange:o,value:t=0,isSmall:r,marginBottom:s=0,marginLeft:i=0,marginRight:a=0,marginTop:m=0,onStart:p,onStop:l})=>{let u=(0,b.useContext)(Ne),d=u&&u.window,k=(M,q)=>{let z=q;d&&d.addEventListener(M,z),window.addEventListener(M,z)},C=(M,q)=>{let z=q;d&&d.removeEventListener&&d.removeEventListener(M,z),window.removeEventListener(M,z)},c=e==="top"||e==="bottom",f=e==="bottom",[y,S]=(0,b.useState)(!1),[g,T]=(0,b.useState)(!1),[w,O]=(0,b.useState)(!1),[E,x]=(0,b.useState)(0),A=(0,b.useRef)(null),[I,B]=(0,b.useState)(0),[H,$]=(0,b.useState)(0),Z=(0,b.useRef)(!1).current,re=M=>{Z=!0;let q=c?M.screenY:M.screenX,z=e==="right"?E-q:q-E;o(Math.max(0,t+z)),$(Math.max(0,(c?M.clientX:M.clientY)-I))},te=()=>{T(!1),Z&&(O(!1),l&&l(e)),Z=!1};(0,b.useEffect)(()=>(g?(k("mousemove",re),k("mouseup",te)):(C("mousemove",re),C("mouseup",te)),()=>{C("mousemove",re),C("mouseup",te)}),[g]);let ge=M=>{let q=document.getElementById("paddings-input-portal"),z=M.target;q&&!q.contains(z)&&A.current&&!A.current.contains(z)&&(O(!1),T(!1),te(),l&&l(e))},se=M=>{M.key==="Escape"&&(O(!1),T(!1),te(),l&&l(e))};(0,b.useEffect)(()=>(g||(w?(k("click",ge),k("keyup",se)):(C("click",ge),C("keyup",se),l&&l(e))),()=>{C("click",ge),C("keyup",se)}),[g,w]);let ae=(0,b.useMemo)(()=>f?y||g?1:0:y||g?2:1,[g,y]),Q=(0,b.useMemo)(()=>c?`calc(100% - ${i+a}px)`:`${ae}px`,[ae,i,a]),xe=(0,b.useMemo)(()=>c?`${ae}px`:`calc(100% - ${s+m}px)`,[ae,s,m]),Pe=(0,b.useMemo)(()=>c?0+i:void 0,[i]),je=(0,b.useMemo)(()=>c?void 0:0+m,[m]),$e=n?"tomato":"blue",gt=(0,b.useMemo)(()=>({width:c?"100%":t,height:c?t:`calc(100% - ${m+s}px)`,marginTop:c?0:m}),[c,t,m,s]),yt=(0,b.useMemo)(()=>({width:f?"100%":c?Q:`${Kt}px`,height:f||c?Kt:xe,left:f?0:Pe,top:je}),[f,c,Q,xe,Pe,je]);return V(R,{ref:A,position:"absolute",width:c?"100%":void 0,height:c?void 0:"100%",left:c?0:void 0,top:c?void 0:0,[e]:0,children:[h(R,{backgroundColor:"rgba(28, 222, 180, 0.18)",style:gt}),V(R,{position:"absolute",onMouseEnter:()=>S(!0),onMouseLeave:()=>S(!1),onMouseDown:M=>{let q=document.getElementById("paddings-input-portal");if(!(q&&q.contains(M.target))){if(!w){let z=M.target.getBoundingClientRect(),le=c?z.x:z.y;B(le),$(Math.max(0,(c?M.clientX:M.clientY)-le)),O(!0)}x(c?M.screenY:M.screenX),T(!0),p&&p(e)}},[e]:f?0:"100%",cursor:c?"row-resize":"col-resize",style:yt,children:[h(R,{position:"absolute",width:c?"100%":void 0,height:c?void 0:"100%",bottom:e==="top"?"100%":void 0,top:e==="bottom"?"100%":void 0,left:e==="right"?"100%":void 0,right:e==="left"?"100%":void 0,children:h(us,{isSmall:r,position:H,isActive:w,onChange:o,value:t,from:e,disabled:g})}),h(R,{display:"flex",width:"100%",height:"100%",alignItems:e==="top"?"flex-start":"flex-end",justifyContent:e==="right"?"flex-end":void 0,children:h(R,{style:{width:c?"100%":`${ae}px`,height:c?`${ae}px`:"100%",backgroundColor:y||g||f||t&&t>0?$e:"transparent"}})})]}),f&&h(R,{position:"absolute",backgroundColor:t&&t>1?$e:"transparent",top:0,height:"1px",style:{left:Pe,width:Q}})]})});sr=fs});function ps({children:e,...n}){let{model:{isEditMode:o,useTextWidgetStore:t}}=(0,ee.useContext)(Fe),{model:r}=(0,ee.useContext)(Le),s=r.flags?.calculatedLineHeight,i=We("TextCanChangePaddings"),[a,m]=t({partial:!1}),[p]=Je(),{blockKey:l,block:u}=(0,ee.useMemo)(()=>{if(!n["data-offset-key"])return{};let x=n["data-offset-key"].split("-")[0],A=a.getCurrentContent().getBlockForKey(x);return{blockKey:x,block:A}},[n,a]),d=(0,ee.useMemo)(()=>de({block:u}),[u]),k=(0,ee.useMemo)(()=>!!(l&&Rn(a,l)),[a,l]),C=k?"var(--editor-border-color)":"transparent",c=(0,ee.useMemo)(()=>[...p.global,...p.project].find(x=>x.name===d),[d,p,a]),{paddings:f,changedPaddings:y}=(0,ee.useMemo)(()=>{let x=bt({block:u}),A=c?Kn(c):{};return{paddings:{left:0,right:0,top:0,bottom:0,...A,...x},changedPaddings:gn({blockPaddings:x,stylePaddings:A})}},[a,u,c,p]),S=x=>{let A=Ue(a),I=a.getCurrentContent(),B=A.reduce((H,$)=>{let Z=I.getBlockForKey($);if(Z){let re=bt({block:Z});return mn({editorState:H,block:Z,paddings:{...re,...x}})}return H},a);m(B)},g=(0,ee.useMemo)(()=>Xe({block:u}),[a,u,p]),T=(0,ee.useMemo)(()=>zn({block:u}),[a,u]),w=(0,ee.useMemo)(()=>s?Mn({block:u,width:r.w}):{},[a,u,p]),O=(0,ee.useMemo)(()=>{if(u&&!Ie({block:u})){let{r:A,g:I,b:B,a:H}=tn(Dn(u));return`rgba(${A}, ${I}, ${B}, ${H})`}},[a,u]),E=i===!1?i:o&&k;return h(R,{...n,position:"relative",style:{lineHeight:typeof g=="number"?`${g}px`:void 0,textIndent:typeof T=="number"?`${T}px`:void 0,...w},css:Xt`
        // Заглушаем паддинги текстового стиля, чтобы отдать управление ими в TextPaddings
        padding: 0 !important;

        // Хак рамки, чтобы у нескольких элементов подряд не вышло 2px рамки
        &:after {
          content: '';
          pointer-events: none;
          box-shadow: 1px 0 0 0 ${C}, 0 1px 0 0 ${C}, 1px 1px 0 0 ${C},
            1px 0 0 0 ${C} inset, 0 1px 0 0 ${C} inset;
          position: absolute;
          top: 0;
          left: -1px;
          width: calc(100% + 1px);
          height: calc(100% - 1px);
        }

        // Дефолтный цвет для списков
        .editor-block-wrapper:before,
        div[data-offset-key]:before,
        & > li:before {
          ${O?`color: ${O};`:""}
        }
      `,children:h(sr,{editable:E,top:f.top,left:f.left,bottom:f.bottom,right:f.right,changedPaddings:y,onChange:S,children:e},l)})}var ee,ar,lr=L(()=>{"use strict";ee=N(ce());qe();pe();we();jt();Sn();kr();Ct();Vn();bn();br();ot();Dt();Ye();oe();ar=ps});var J,pt,cr,ms,gs,dr,ur=L(()=>{"use strict";J=N(ce()),pt=N(Ge());we();cr=N(Sr());be();Qn();pe();Ro();hr();at();Lo();Mo();En();Ar();kt();qe();st();De();ht();Tt();lr();Re();ot();dn();oe();ms=()=>{let e=window.RM.constructorRouter&&!window.RM.constructorRouter.preview,n={...an(),...en,...cn};return cr.default.Map(Object.keys(n).reduce((o,t)=>{let r=n[t].element,s=e?ar:r,i=nt(t)?h(eo,{type:t}):void 0;return Object.assign(o,{[t]:{...n[t],element:s,wrapper:i}}),o},{}))},gs=(0,J.forwardRef)(({isEditMode:e,textDirection:n,autosize:o,columns:t,verticalAlign:r,bgColor:s,selectionColor:i,shouldShowSelectionBorder:a,useBaseline:m,disableSelectionHighlight:p,...l},u)=>{let d=(0,J.useRef)(null),k=(0,J.useContext)(Ne),C=We("TextCanChangeTypography");(0,J.useEffect)(()=>{if(d&&d.current!==null){let g=k&&k.window||window,T=d,w=wo(T,g),O=_o(T,g),E=Io(T,{forceCleanText:!C});return()=>{w.unregister(),O?.unregister(),E?.unregister()}}},[d]),(0,J.useEffect)(()=>{let g=u;g!==null&&g.current&&d.current&&!g.current.focusEditor&&(g.current.focusEditor=d.current.focus)},[d,u]);let c=(0,J.useCallback)((g,T,w,O)=>{let{mag:E,workspace:x}=window.RM.constructorRouter,A=Ao(g,w,E),I;switch(A){case"Link":{let B=et(g,E);if(B){let H=rn(),$=kn(E,H.project,H.global)||yn.name;I=vn({editorState:w,url:g,type:B,linkStyle:$}),x.controls?.select(x.controls?.findControl("text_link"))}break}case"Text":{I=Po({text:g,html:T,editorState:w,pastedWithShift:O});break}}return I?(O||window.RM.constructorRouter.trigger("notice:triggerEduTip","textWidgetPasteWithoutFormatting",{showOnce:!0}),l.onChange(I),"handled"):"not-handled"},[l.onChange]),f=(0,J.useCallback)((g,T)=>{if(g.shiftKey){U("constructor.startTrackingUserActionsAcrossWidgetsAndInterface")&&P("shortcut_shift_enter");let O=Un(T);return l.onChange(O),"handled"}let w=Ln(T);if(w){let{status:O,editorState:E}=w;return l.onChange(E),O}return"not-handled"},[l.onChange]),y=(0,J.useCallback)(g=>g?(l.onChange(_n({editorState:l.editorState,dropSelection:g})),"handled"):"not-handled",[l.onChange,l.editorState]),S=(0,J.useMemo)(()=>pt.DefaultDraftBlockRenderMap.merge(ms()),[]);return h(Zn,{ref:u,textDirection:n,autosize:o,columns:t,verticalAlign:r,bgColor:s,selectionColor:i,shouldShowSelectionBorder:a,useBaseline:m,isEditMode:e,disableSelectionHighlight:p,children:h(R,{children:h(pt.Editor,{ref:d,spellCheck:!1,autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",stripPastedStyles:!1,blockRenderMap:S,customStyleFn:nn,handlePaste:c,handleReturn:f,handleDrop:y,...l})})})}),dr=gs});var W,fr,Pl,pr=L(()=>{"use strict";W=N(ce());be();qe();pe();Re();ot();Tt();Ct();vr();Gt();fr=(e,n={})=>{let[o,t]=St(),[r]=Je(),s=Array.isArray(e)?e:[e],i=(0,W.useMemo)(()=>s.map(c=>In(c)),[s]),a=(0,W.useMemo)(()=>[...r.global,...r.project],[r.global,r.project]),m=(0,W.useMemo)(()=>s.map(c=>de({editorState:c})),[s]),p=(0,W.useMemo)(()=>m.map(c=>a.find(f=>f.name===c)).filter(Boolean),[m,a]),l=(0,W.useMemo)(()=>s.map((c,f)=>{let y=K(c,"FONT_FAMILY"),S=p[f];return y.length?y[0]:S?S.cssProperties.fontFamily||"":Y.fontFamily}),[p,s]),u=(0,W.useMemo)(()=>s.map((c,f)=>{let y=K(c,"FONT_STYLE"),S=p[f];return y.length?y[0]:S?S.cssProperties.fontStyle||"":Y.fontStyle}),[p,s]),d=(0,W.useMemo)(()=>s.map((c,f)=>{let y=K(c,"FONT_WEIGHT"),S=p[f];return y.length?y[0]:S?S.cssProperties.fontWeight||"":Y.fontWeight}),[p,s]);(0,W.useEffect)(()=>{if(n.listenFontFeaturesUpdates&&l.length&&d.length&&u.length){let c=s.map((f,y)=>{let S=Vt(l)[y],g=d[y],T=u[y];if(S){let w=Oe({fontFamily:S,fontWeight:g,fontStyle:T});if(!o[w])return vt({fontFamily:S,fontWeight:g,fontStyle:T}).then(E=>({res:E,key:w}))}});Promise.all(c).then(f=>{let y={};f.forEach(S=>{S?.res&&(y[S.key]=S.res)}),Object.keys(y).length!==0&&t({...o,...y})})}},[s]);let k=(0,W.useMemo)(()=>s.map((c,f)=>{let y=l[f],S=d[f],g=u[f];if(y&&S&&g){let T=Oe({fontFamily:y,fontWeight:S,fontStyle:g});return o[T]}}),[s,o]);return(0,W.useMemo)(()=>{let c={textStyle:[],textStyleName:[],fontFamily:[],fontStyle:[],fontWeight:[],fontInfo:[],fontSize:[],lineHeight:[],ratio:[],letterSpacing:[],fontSizeLinkStatus:[],letterSpacingLinkStatus:[]};for(let f=0;f<s.length;f++){let y=s[f],S=p[f],g=i[f],T=k[f],w=m[f],O=l[f],E=u[f],x=d[f],A=S&&S.name!=="unstyled",I=A&&ke(S?.cssProperties.fontSize),B=A&&ke(S?.cssProperties.lineHeight),H=A&&ke(S?.cssProperties.letterSpacing,!0),$=K(y,"FONT_SIZE"),Z=K(y,"LETTER_SPACING"),re=Xe({block:g}),te=K(y,"IS_LINKED_LETTER_SPACING"),ge=hn({block:g}),se=$?.length?parseInt($[0]):I||Y.fontSize,ae=Z?.length?parseFloat(Z[0]):H||0,Q=typeof re=="number"?re:B||Y.lineHeight,xe=te&&te[0]&&typeof te[0]<"u"?te[0]==="true":!1;c.textStyle.push(S),c.textStyleName.push(w),c.fontFamily.push(O),c.fontStyle.push(E),c.fontWeight.push(x),c.fontInfo.push(T),c.fontSize.push(se),c.lineHeight.push(Q),c.ratio.push(se/Q),c.letterSpacing.push(ae),c.fontSizeLinkStatus.push(ge),c.letterSpacingLinkStatus.push(xe)}return c},[s,i,p,l,k,u,d,m])},Pl=(e,n={})=>{let[o,t]=St(),[r]=sn(),s=(0,W.useMemo)(()=>[...r.global,...r.project],[r.global,r.project]),i=(0,W.useMemo)(()=>Ie({editorState:e}),[e]),a=(0,W.useMemo)(()=>s.find(d=>d.name===i),[s,i]),m=(0,W.useMemo)(()=>{let d=K(e,"FONT_FAMILY");return a?a.cssProperties.fontFamily||"":d.length?d[0]:Y.fontFamily},[a,e,i]),p=(0,W.useMemo)(()=>{let d=K(e,"FONT_STYLE");return a?a.cssProperties.fontStyle||Y.fontStyle:d.length?d[0]:Y.fontStyle},[a,e,i]),l=(0,W.useMemo)(()=>{let d=K(e,"FONT_WEIGHT");return a?a.cssProperties.fontWeight||"":d.length?d[0]:Y.fontWeight},[a,e,i]);(0,W.useEffect)(()=>{if(n.listenFontFeaturesUpdates&&m&&l&&p){let d=Oe({fontFamily:m,fontWeight:l,fontStyle:p});o[d]||vt({fontFamily:m,fontWeight:l,fontStyle:p}).then(C=>{if(C){let{features:c,variations:f,characters:y}=C;t({...o,[d]:{features:c,variations:f,characters:y}})}})}},[e,n.listenFontFeaturesUpdates]);let u=(0,W.useMemo)(()=>{if(m&&l&&p){let d=Oe({fontFamily:m,fontWeight:l,fontStyle:p});return o[d]}},[e,o]);return{listStyle:a,listStyleName:i,fontFamily:m,fontStyle:p,fontWeight:l,fontInfo:u}}});function ys({readOnly:e}){let{model:n,modelSet:o,modelSave:t}=(0,v.useContext)(Le),{model:{useTextWidgetStore:r,isEditMode:s,workspace:i,selected:a,isJustCreated:m,disableSelectionHighlight:p,isResizing:l}}=(0,v.useContext)(Fe),[u,d]=r({partial:!1});fr(u,{listenFontFeaturesUpdates:!0});let{isPaddingsEnabled:k}=(0,v.useContext)(ft),{callback:C}=At(t,400),{callback:c}=At(x=>{if(s&&x.getLastChangeType()){let I=An(x.getCurrentContent()),B=Object.keys(I),H=(0,mt.pick)(n,...B),$=(0,mt.isEqual)(I,H);o(I),$||C()}},20);(0,v.useEffect)(()=>{s&&m&&setTimeout(()=>{S.current?.focusEditor()},0)},[]),(0,v.useEffect)(()=>{c(u)},[u]);let f=(0,v.useMemo)(()=>u.getSelection().getHasFocus(),[u]),y=(0,v.useMemo)(()=>s,[s,f]),S=(0,v.useRef)(null),{height:g}=_e(S),T=(0,v.useMemo)(()=>n.columns&&n.columns.count>1,[n.columns]);(0,v.useEffect)(()=>{!l&&g>0&&g!==n.h&&s&&!T&&n.autosize&&(o({h:g}),C())},[g,n.autosize,n.h,T,l]),(0,v.useEffect)(()=>{!Modernizr.firefox&&!s&&!u.getSelection().isCollapsed()&&d(Pn(u))},[s]);let w=(0,v.useCallback)(x=>{let A=x.getType(),I=de({block:x}),B=un({block:x}),H=nt(A)?Ie({block:x})||(n.flags?.newListPosition?ln:void 0):void 0;return["edit-mode",A,I,B,H].filter($=>$).join(" ")},[]),O=(0,v.useCallback)(x=>{let A=x.getSelection(),I=x;I=Bn(I,u),I=Ee(I,On(A)),I=I.getSelection().isCollapsed()?I:Ee(I,tt(I)),Modernizr.safari&&!A.isCollapsed()&&(I=Ee(I,I.getSelection(),!1)),d(I)},[u]),E=(0,v.useCallback)(x=>{let A=xo({action:x,editorState:u,workspace:i});if(A){let{editorState:I,status:B}=A;return d(I),B}else return"not-handled"},[u,i]);return h(dr,{ref:S,isEditMode:s,bgColor:n.bgColor,selectionColor:n.selectionColor,textDirection:n.textDirection||"LTR",autosize:n.autosize,columns:n.columns,verticalAlign:n.verticalAlign,useBaseline:n.flags?.baseline,shouldShowSelectionBorder:y,editorState:u,disableSelectionHighlight:p,blockStyleFn:w,onChange:O,readOnly:!s||!a||e||k,keyBindingFn:To,handleKeyCommand:E})}function hs({size:e,height:n,width:o,onClick:t}){return V(ye,{children:[h(R,{position:"absolute",top:0,left:0,onClick:t,userSelect:"none",style:{width:o+e*2,height:e}}),h(R,{position:"absolute",bottom:0,left:0,onClick:t,userSelect:"none",style:{width:o+e*2,height:e}}),h(R,{position:"absolute",top:0,left:0,width:e,onClick:t,userSelect:"none",style:{width:e,height:n+e*2}}),h(R,{position:"absolute",top:0,right:0,onClick:t,userSelect:"none",style:{width:e,height:n+e*2}})]})}function Ts(){let{model:{useTextWidgetStore:e,fontStyles:n,isResizing:o,leaveEditMode:t,isEditMode:r,canControlsBeClosed:s,onIframeLoaded:i}}=(0,v.useContext)(Fe),[a]=e({partial:!1}),{model:{w:m,h:p}}=(0,v.useContext)(Le),[l,u]=(0,v.useState)(!1);(0,v.useEffect)(()=>{l&&jn()},[l,o]);let d=(0,v.useRef)(null),k=(0,v.useMemo)(()=>{let E={position:"absolute",top:Te*-1,left:Te*-1,width:`calc(100% + ${Te*2}px)`,height:`calc(100% + ${Te*2}px)`};return{display:r?void 0:"none",pointerEvents:!r||l||o?"none":void 0,userSelect:"none",...E}},[Te,r,l,o]),C=(0,v.useCallback)(()=>{s()&&t()},[s,t]),[c,f]=(0,v.useState)(!1),[y,S]=(0,v.useState)(!1);(0,v.useEffect)(()=>{r&&!c&&f(!0)},[r]);let[g,T]=(0,v.useState)(!1),w=(0,v.useRef)(null),O=()=>{let E=d.current?.contentDocument?.hasFocus()||!1;if(E){let x=d.current?.contentDocument?.getSelection();x&&x.anchorNode&&x.focusNode&&(w.current={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset})}T(E)};return(0,v.useEffect)(()=>(d.current?.contentDocument?.addEventListener("selectionchange",O),()=>{d.current?.contentDocument?.removeEventListener("selectionchange",O)}),[d.current?.contentDocument]),(0,v.useEffect)(()=>{if(Modernizr.safari){let E=a.getSelection(),x=E.getHasFocus();if(!g&&x&&!E.isCollapsed()){let A=d.current?.contentWindow?.getSelection();A&&w.current&&A.setBaseAndExtent(w.current.anchorNode,w.current.anchorOffset,w.current.focusNode,w.current.focusOffset)}}},[a,g]),h($t.Provider,{value:{ref:d},children:h(ft.Provider,{value:{isPaddingsEnabled:l,setIsPaddingsEnabled:u},children:V(R,{position:"relative",width:"calc(var(--workspace-inverse-zoom) * 100%)",height:"calc(var(--workspace-inverse-zoom) * 100%)",zoom:"var(--workspace-inverse-zoom)",transform:"scale(var(--workspace-zoom))",transformOrigin:"left top",children:[c&&V(Oo,{ref:d,style:k,head:V(ye,{children:[h("style",{children:`
                      body {
                        margin: 0;
                        height: 100vh;
                        width: 100vw;
                        overflow: hidden;
                        box-sizing: border-box;
                        padding: ${Te}px ${Te-Xn}px;
                      }

                      ol, ul {
                        padding: 0;
                        margin: 0;
                      }
                  `}),n.map((E,x)=>{if(E.tag==="style")return h("style",{children:`${E.style}`},x);if(E.tag==="link")return h("link",{rel:"stylesheet",type:E.type,href:E.href},x)})]}),contentDidMount:()=>{i(),S(!0)},children:[h(io,{mode:"constructor"}),r&&h(Ss,{size:Te,height:p,width:m,onClick:C}),h(ys,{})]}),r&&y?null:h(R,{height:"100%",width:"100%",position:"absolute",top:0,left:0,pointerEvents:"none",userSelect:"none",children:h(to,{editorState:a,isConstructorPreview:!0})})]})})})}var v,mt,mr,$t,Ss,Te,nc,ir=L(()=>{v=N(ce()),mt=N(gr());Br();bn();mr=N(Ur());ur();pe();Er();pn();jt();Sn();Ut();Dr();ot();dn();Fr();we();at();Qn();pr();oo();Rr();oe();$t=(0,v.createContext)({});Ss=(0,v.memo)(hs,mr.default),Te=500;nc=Ts});export{Me as a,uo as b,Os as c,Nr as d,Fs as e,Wr as f,Ls as g,Us as h,_s as i,Ms as j,fo as k,Ds as l,po as m,me as n,Ot as o,Co as p,bo as q,go as r,De as s,Be as t,Ft as u,P as v,st as w,Fo as x,zi as y,We as z,Lo as A,$o as B,zo as C,dt as D,Go as E,qo as F,Xo as G,nr as H,or as I,fr as J,Pl as K,pr as L,$t as M,Te as N,nc as O,ir as P};
